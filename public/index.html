<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Lite Notes</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <div class="container">
    <h1>Lite Notes</h1>

    <div class="actions">
      <button id="saveButton">保存笔记</button>
      <button id="historyButton">历史记录</button>
      <button id="logoutButton">退出登录</button>
    </div>

    <textarea id="note" placeholder="在这里输入你的笔记..."></textarea>

    <div class="tags">
      <input type="text" id="tagInput" placeholder="添加标签 (用英文逗号分隔)">
    </div>

    <div id="search">
      <input type="text" id="searchInput" placeholder="搜索笔记内容...">
      <button id="searchButton">搜索</button>
    </div>
  </div>

  <script src="/autosave.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const saveButton = document.getElementById('saveButton');
      const historyButton = document.getElementById('historyButton');
      const logoutButton = document.getElementById('logoutButton');
      const searchButton = document.getElementById('searchButton');

      saveButton.addEventListener('click', function() {
        fetch('/save', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            note: document.getElementById('note').value,
            tags: document.getElementById('tagInput').value.split(',').map(t => t.trim())
          })
        }).then(res => {
          if (res.ok) alert('保存成功！');
          else alert('保存失败');
        });
      });

      historyButton.addEventListener('click', function() {
        window.location.href = '/history';
      });

      logoutButton.addEventListener('click', function() {
        window.location.href = '/logout';
      });

      searchButton.addEventListener('click', function() {
        const query = document.getElementById('searchInput').value;
        if (query) {
          window.location.href = '/search?q=' + encodeURIComponent(query);
        }
      });
    });
  </script>
</body>
</html>
